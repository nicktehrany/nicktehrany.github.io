<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content>
<meta name=description content="IN4191 Security and Cryptography Notes">
<meta name=keywords content>
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=https://nicktehrany.github.io/notes/in4191-security-and-cryptography-notes/lecture-11/>
<title>
Lecture 11: Certificates, Key Transport, and Key Agreement
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=/main.89fa80e2143f71bd5c96a7c94e531dec3276a367e22f87e74a76026ab64680bf.css>
<meta itemprop=name content="Lecture 11: Certificates, Key Transport, and Key Agreement">
<meta itemprop=description content="IN4191 Security and Cryptography Notes"><meta itemprop=datePublished content="2021-01-15T00:00:00+00:00">
<meta itemprop=dateModified content="2021-01-15T00:00:00+00:00">
<meta itemprop=wordCount content="476"><meta itemprop=image content="https://nicktehrany.github.io">
<meta itemprop=keywords content>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://nicktehrany.github.io">
<meta name=twitter:title content="Lecture 11: Certificates, Key Transport, and Key Agreement">
<meta name=twitter:description content="IN4191 Security and Cryptography Notes">
<meta property="og:title" content="Lecture 11: Certificates, Key Transport, and Key Agreement">
<meta property="og:description" content="IN4191 Security and Cryptography Notes">
<meta property="og:type" content="article">
<meta property="og:url" content="https://nicktehrany.github.io/notes/in4191-security-and-cryptography-notes/lecture-11/"><meta property="og:image" content="https://nicktehrany.github.io"><meta property="article:section" content="notes">
<meta property="article:published_time" content="2021-01-15T00:00:00+00:00">
<meta property="article:modified_time" content="2021-01-15T00:00:00+00:00"><meta property="og:site_name" content="Nick Tehrany">
<meta property="article:published_time" content="2021-01-15 00:00:00 +0000 UTC">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>$</span>
<span class=logo__text>cd nicktehrany</span>
<span class=logo__cursor>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=/awards>Awards</a></li><li><a href=/publications>Publications</a></li><li><a href=/projects>Projects</a></li><li><a href=/posts>Blog</a></li><li><a href=/notes>Uni Notes</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<main class=posts>
<div class=post-info>
<p>
</p>
</div>
<article>
<h1 class=post-title>
<a href=https://nicktehrany.github.io/notes/in4191-security-and-cryptography-notes/lecture-11/>Lecture 11: Certificates, Key Transport, and Key Agreement</a>
</h1>
<div class=post-content>
<h2 id=certificates-key-transport-and-key-agreement-chapter-18>Certificates, Key Transport, and Key Agreement (Chapter 18)</h2>
<p>What is key management?</p>
<ul>
<li>Key generation</li>
<li>Key distribution</li>
<li>Key storage</li>
<li>Key change</li>
<li>Key usage</li>
<li>Key destruction</li>
</ul>
<p>Requirements of key generation:</p>
<ul>
<li>secret</li>
<li>unpredictable</li>
<li>strong key</li>
</ul>
<p>It is often desirable to frequently change the key in a cryptographic system.</p>
<p>Types of keys:</p>
<ul>
<li><strong>Static (or Long Term) Keys:</strong> few hours to a few years</li>
<li><strong>Ephemeral or Session (or Short Term) Keys</strong> a few seconds or a day</li>
</ul>
<h3 id=certificates-and-certificate-authority>Certificates and Certificate Authority</h3>
<p>We need a binding, linking a public key to an entity. This is achieved for physical tokens such as smart cards with biometrics or PINs, and otherwise we can use digital certificates.</p>
<p>This requires a trusted third party (TTP) or a certificate authority (CA).</p>
<p>The system of CAs and certificates is called the Public Key Infrastructure (PKI).</p>
<h4 id=implicit-certificates>Implicit Certificates</h4>
<p>Typical certificates are large which can be undesirable in small systems and therefore we can have smaller certificates that bind the public key and the data in the form of $X|Y$ where $X$ is the data being bound to the public key and $Y$ is the implicit certificate on $X$.</p>
<h4 id=fresh-ephemeral-symmetric-keys-form-static-symmetric-keys>Fresh Ephemeral Symmetric Keys form Static Symmetric Keys</h4>
<p>Derive short term keys form long term keys using symmetric systems.
Definitions:</p>
<ul>
<li>Parties: A, B, and TTP</li>
<li>Shared Keys: $K_{ab}$,$K_{bs}$, $K_{as}$</li>
<li>Nonces: numbers used only once, unique but not necessarily random</li>
<li>Timestamps: $T_a$, $T_b$</li>
</ul>
<p>$$A\rightarrow B: \color{blue}{M,A,B,}\{\color{red}{N_a,M,A,B}\}\color{red}{K_{as}}$$</p>
<p><strong>Wide-Mouth Frog Protocol</strong></p>
<p><img src=/images/IN4191/Wide-Mouth-Frog.png alt="Wide-Mouth Frog Protocol"></p>
<p>Problem of replay attacks if clocks are not synchronized.</p>
<p><strong>Needham-Schroeder Protocol</strong></p>
<p><img src=/images/IN4191/Needham_schroeder.png alt="Needham-Schroeder Protocol"></p>
<p><strong>Kerberos</strong></p>
<p>Authentication system is based on symmetric encryption, and it uses timestamps with synchronized clocks (a requirement that clocks are synced).</p>
<p><img src=/images/IN4191/Kerberos.png alt=Kerberos></p>
<h4 id=fresh-ephemeral-symmetric-keys-from-static-public-keys>Fresh Ephemeral Symmetric Keys from Static Public Keys</h4>
<p>Problem that TTP based solution assume that there is a shared long term key, solving this can be done in two ways, key transport based on public key cryptography, or kry agreement that outputs a symmetric key.</p>
<p>Alice sends the symmetric key to Bob by encrypting it with Bob&rsquo;s public key.</p>
<p><img src=/images/IN4191/key-transport.png alt="Key Transport"></p>
<p><strong>Forward secrecy:</strong> a compromise on a key should not lead to security problems on the previous messages decrypted before that time.</p>
<h4 id=diffie-hellman-key-exchange-protocol>Diffie-Hellman Key Exchange Protocol</h4>
<p>It enables two entities to establish a symmetric key even though they have never met before, based on the discrete log problem, and works with a finite field version on abelian group $G$ of order $q$, and an elliptic curve version.</p>
<p><img src=/images/IN4191/Diffie-Hellman-Key-Exchange.png alt="Diffie-Hellman Key Exchange"></p>
<p>Has the problem of man in the middle attacks.</p>
<p><img src=/images/IN4191/Signed-Diffie-Hellman.png alt="Signed Diffie-Hellman Key Exchange"></p>
<p>Signed is still not secure as the attacker can change the signature. The randomness of $g^a$ or $g^b$ is not linked with the ID of the sender.</p>
<h4 id=station-to-station-sts-protocol>Station-to-Station (STS) Protocol</h4>
<p><img src=/images/IN4191/STS.png alt=STS></p>
<h4 id=blake-wilson-menezes-protocol>Blake-Wilson-Menezes Protocol</h4>
<p>Achieving authentication without signatures and MACs. It assumes that Alice and Bob have long term keys $(g^a,a)$ and $(g^b,b)$ respectively, and they obtain each others public key via certificates, then</p>
<p>$$A\rightarrow B: \mathfrak{ek}_A=g^x$$</p>
<p>$$B\rightarrow A: \mathfrak{ek}_B=g^y$$</p>
<p>Then Alice computes</p>
<p>$$k\leftarrow H(\mathfrak{pk}_B^x,\mathfrak{ek}_B^a)=H(g^{b<em>x},g^{y</em>a})$$</p>
<p>Bob computes</p>
<p>$$k\leftarrow H(\mathfrak{ek}_A^b,\mathfrak{pk}_A^y)=H(g^{x<em>b},g^{a</em>y})$$</p>
<script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}},window.addEventListener('load',a=>{document.querySelectorAll("mjx-container").forEach(function(a){a.parentElement.classList+='has-jax'})})</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
</div>
</article>
<hr>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
476 Words
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2021-01-15
</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://nicktehrany.github.io/notes/in4191-security-and-cryptography-notes/lecture-12/>
<span class=button__icon>←</span>
<span class=button__text>Lecture 12: Secret Sharing</span>
</a>
</span>
<span class="button next">
<a href=https://nicktehrany.github.io/notes/in4191-security-and-cryptography-notes/lecture-10/>
<span class=button__text>Lecture 10: Public Key Encryption and Signature Algorithms</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</main>
</div>
<footer class=footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css>
<div>
<div>
&nbsp; <a href=https://github.com/nicktehrany target=_blank rel=noopener title=Github><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a> &nbsp;&nbsp; <a href=https://www.linkedin.com/in/nicktehrany/ target=_blank rel=noopener title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a> &nbsp;
<a href=/misc/cv.pdf target=_self><i class="ai ai-cv ai-2x"></i></a>
<a href=https://www.semanticscholar.org/author/Tehrany/2105151990 target=_self><i class="ai ai-semantic-scholar ai-2x"></i></a>
</div>
</div>
<div class=footer__inner>
<div class=footer__content>
<span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Themed by <a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng>Hello Friend NG</a></span>
</div>
</div>
</footer>
</div>
<script type=text/javascript src=/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js integrity="sha512-LOZOpupEpysT3YEvwutcyj7+h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script>
</body>
</html>